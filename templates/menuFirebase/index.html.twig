{% extends 'baseAdmin.html.twig' %}
{% block body %}


{% for label, messages in app.flashes %}
    {% for message in messages %}
        <div class="alert alert-{{ label }} mb-3" role="alert">
            {% if label == 'success' %}
                <i class="fas fa-check-circle me-2"></i>
            {% elseif label == 'warning' %}
                <i class="fas fa-exclamation-triangle me-2"></i>
            {% elseif label == 'danger' %}
                <i class="fas fa-times-circle me-2"></i>
            {% else %}
                <i class="fas fa-info-circle me-2"></i>
            {% endif %}
            {{ message }}
        </div>
    {% endfor %}
{% endfor %}

{# Header avec bouton d'ajout #}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Gestion des Menus</h2>
    <a href="{{ path('firebase_menu_add') }}" class="btn btn-primary">
        <i class="fas fa-plus me-2"></i>Ajouter un menu
    </a>
</div>

{# Tableau des menus ou message si vide #}
{% if menus is not empty %}
    <div class="card">
        <div class="card-body p-0">
            <table class="table align-items-center justify-content-center mb-0">
                <thead>
                    <tr>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Menu</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Type</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Description</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder text-center opacity-7 ps-2" style="min-width: 120px;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for key, menu in menus %}
                        <tr>
                            <td>
                                <div class="d-flex px-2 align-items-center">
                                    <div class="me-3">
                                        {% if menu.image %}
                                            <img src="{{ menu.image }}" class="menu-image" alt="{{ menu.titre }}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 8px;">
                                        {% else %}
                                            <div class="menu-placeholder d-flex align-items-center justify-content-center" 
                                                 style="width: 50px; height: 50px; background-color: #6c757d; color: white; border-radius: 8px; font-weight: bold;">
                                                {{ menu.titre|slice(0, 1)|upper }}
                                            </div>
                                        {% endif %}
                                    </div>
                                    <div class="my-auto">
                                        <h6 class="mb-0 text-sm">{{ menu.titre }}</h6>
                                    </div>
                                </div>
                            </td>
                            <td>
                                {% if menu.type %}
                                    <span class="badge bg-primary text-xs font-weight-bold">{{ menu.type }}</span>
                                {% else %}
                                    <span class="text-muted text-xs">Non spécifié</span>
                                {% endif %}
                            </td>
                            <td>
                                <p class="text-sm mb-0">
                                    {% if menu.description %}
                                        {{ menu.description|length > 80 ? menu.description|slice(0, 80) ~ '...' : menu.description }}
                                    {% else %}
                                        <span class="text-muted">Aucune description</span>
                                    {% endif %}
                                </p>
                            </td>
                            <td class="align-middle text-center">
                                <div class="d-flex justify-content-center gap-2">
                                    <a href="{{ path('firebase_menu_edit', {'key': key}) }}" 
                                       class="btn btn-warning btn-sm" 
                                       title="Modifier">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                    <form method="POST" 
                                          action="{{ path('firebase_menu_delete', {'key': key}) }}" 
                                          style="display: inline;" 
                                          onsubmit="return confirm('Êtes-vous sûr de vouloir supprimer le menu « {{ menu.titre }} » ?');">
                                        <button type="submit" 
                                                class="btn btn-danger btn-sm" 
                                                title="Supprimer">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% else %}
    {# Message si aucun menu #}
    <div class="text-center mt-4">
        <div class="card">
            <div class="card-body py-5">
                <i class="fas fa-utensils fa-3x text-muted mb-3"></i>
                <h5 class="text-muted">Aucun menu trouvé</h5>
                <p class="text-muted mb-3">Commencez par ajouter votre premier menu.</p>
                <a href="{{ path('firebase_menu_add') }}" class="btn btn-primary">
                    <i class="fas fa-plus me-2"></i>Ajouter un menu
                </a>
            </div>
        </div>
    </div>
{% endif %}

<style>
.menu-image {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border-radius: 8px;
}
.table th {
    border-bottom: 1px solid #e9ecef;
    font-weight: 600;
}
.gap-2 {
    gap: 0.5rem;
}
</style>


{% endblock %}